$p = $ExecutionContext.SessionState.Path
$path = $p.GetUnresolvedProviderPathFromPSPath("<%= path %>")
$index = <%= index %>
$chunkSize = <%= chunk_size %>
if (Test-Path $path -PathType Leaf) {
  $file = [System.IO.File]::OpenRead($path)
  $file.Seek($index)
  $bytes = [System.convert]::ToBase64String($file.Read($chunkSize))
  Write-Host $bytes
  exit 0
}
ElseIf (Test-Path $path -PathType Container) {
  exit 2
}
exit 1
